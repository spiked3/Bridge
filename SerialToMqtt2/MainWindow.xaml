<Window x:Class="SerialToMqtt2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:spiked3"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        Title="Serial to MQTT Bridge 2.0 / WPF" Height="350" Width="525" Loaded="Window_Loaded" Closing="Window_Closing">
    
    <Window.Resources>
        <DataTemplate x:Key="ComPortItemTemplate" >
            <Border BorderThickness="1" BorderBrush="Gray" HorizontalAlignment="Stretch" >
                <StackPanel Orientation="Horizontal" Background="White"   >
                    <TextBlock Text="{Binding Path=SerialPort.PortName, FallbackValue=Name}" TextBlock.FontWeight="Bold" VerticalAlignment="Center" Margin="4" />
                    <TextBlock Text="  " />
                    <Ellipse Width="18" Height="18" Fill="{Binding ReceiveBrush}"  Margin="4" />
                    <TextBlock Text="  " />
                    <Ellipse Width="18" Height="18" Fill="{Binding TransmitBrush}"  Margin="4" />
                </StackPanel>
            </Border>
        </DataTemplate>
    </Window.Resources>
    <DockPanel LastChildFill="True">
        <Menu DockPanel.Dock="Top" >
            <MenuItem Header="_File" Click="MenuItem_Click" >
                <Separator />
                <MenuItem Header="E_xit" />
            </MenuItem>
        </Menu>
        <Expander ExpandDirection="Up" Header="Settings" DockPanel.Dock="Bottom" >
            <StackPanel Orientation="Horizontal" >
                <CheckBox Content="Details" IsChecked="{Binding ShowDetails, Mode=TwoWay}" />
            </StackPanel>
        </Expander>
        
        <ListBox DockPanel.Dock="Right" ItemsSource="{Binding ComPorts}" ItemTemplate="{StaticResource ComPortItemTemplate}" >
            <ListBox.Background>
                <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.AppWorkspaceColorKey}}"/>
            </ListBox.Background>
        </ListBox>

        <local:Console />
    </DockPanel>
</Window>
